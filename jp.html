<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vocabulary Page</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-4">
<h1 class="text-3xl font-bold mb-6 text-center">Vocabulary</h1>
<div id="categories" class="grid gap-8"></div>

<script>
// 发音函数
function speak(text) {
    const utter = new SpeechSynthesisUtterance(text);
    utter.lang = 'en-US';
    speechSynthesis.speak(utter);
}

// 尝试加载图片，多图源轮询
function loadImage(sources, imgEl, index = 0) {
    if (index >= sources.length) return;
    const url = `https://source.unsplash.com/160x160/?${sources[index]}`;
    const img = new Image();
    img.src = url;
    img.onload = () => imgEl.src = url;
    img.onerror = () => loadImage(sources, imgEl, index + 1);
}

// 渲染 JSON 数据
fetch('categories.json')
.then(res => res.json())
.then(data => {
    const container = document.getElementById('categories');
    Object.keys(data).forEach(category => {
        const catDiv = document.createElement('div');
        catDiv.className = "bg-white p-4 rounded shadow";
        const catTitle = document.createElement('h2');
        catTitle.textContent = category;
        catTitle.className = "text-2xl font-semibold mb-4";
        catDiv.appendChild(catTitle);

        const grid = document.createElement('div');
        grid.className = "grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4";

        data[category].forEach(item => {
            const card = document.createElement('div');
            card.className = "bg-gray-50 p-2 rounded text-center cursor-pointer hover:shadow-lg transition";

            // 图片
            const img = document.createElement('img');
            img.className = "mx-auto mb-2 w-24 h-24 object-cover rounded";
            img.loading = "lazy";
            loadImage(item.iconSources, img);

            // 英文
            const eng = document.createElement('div');
            eng.textContent = item.english;
            eng.className = "font-medium";
            eng.onclick = () => speak(item.english);

            // 日文
            const jp = document.createElement('div');
            jp.textContent = item.japanese;
            jp.className = "text-gray-600";

            card.appendChild(img);
            card.appendChild(eng);
            card.appendChild(jp);
            grid.appendChild(card);
        });

        catDiv.appendChild(grid);
        container.appendChild(catDiv);
    });
});
</script>
</body>
</html>
